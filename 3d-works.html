<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Works - Sydney Silva</title>
    
    <!-- Three.js for 3D rendering -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- GLTFLoader for loading 3D models -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <!-- OBJLoader for loading OBJ models -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/OBJLoader.js"></script>
    <!-- OrbitControls for mouse interaction -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Outfit', sans-serif;
            background: linear-gradient(rgba(0,0,0,0.1), rgba(0,0,0,0.1)), url('images/backgrounds/33.png?v=7');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .back-link:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(-5px);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 80px 20px 40px;
        }
        
        h1 {
            text-align: center;
            font-size: 3em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            text-align: center;
            font-size: 1.2em;
            margin-bottom: 40px;
            opacity: 0.9;
        }
        
        .viewer-container {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 40px;
        }
        
        .viewers-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 20px;
        }
        
        .viewer-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .viewer-title {
            font-size: 1.2em;
            margin-bottom: 15px;
            color: #4ecdc4;
            text-align: center;
        }
        
        #viewer, #viewer2 {
            width: 100%;
            height: 350px;
            border-radius: 15px;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            position: relative;
            overflow: hidden;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
        }
        
        .control-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .control-btn.active {
            background: rgba(255, 255, 255, 0.4);
            border-color: rgba(255, 255, 255, 0.6);
        }
        
        .model-info {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .gallery-section {
            margin-top: 40px;
        }
        
        .gallery-title {
            font-size: 2em;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .series-description {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .series-description p {
            font-size: 1.1em;
            line-height: 1.7;
            text-align: center;
            opacity: 0.9;
            margin: 0;
        }
        
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            margin-top: 30px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }
        
        
        /* Mobile responsive */
        @media (max-width: 768px) {
            .gallery-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 20px;
            }
            
            .gallery-image {
                height: 200px;
                object-fit: cover;
            }
        }
        
        .gallery-item {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .gallery-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .gallery-image {
            width: 100%;
            height: 280px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .gallery-item-title {
            font-size: 1.3em;
            margin-bottom: 10px;
            color: white;
            font-weight: 600;
        }
        
        .gallery-item-description {
            font-size: 0.9em;
            line-height: 1.5;
            opacity: 0.9;
        }
        
        /* Modal for enlarged images */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            cursor: pointer;
        }
        
        .modal-content {
            margin: auto;
            display: block;
            width: 90%;
            max-width: 800px;
            max-height: 90%;
            object-fit: contain;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 10px;
        }
        
        .close {
            position: absolute;
            top: 15px;
            left: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover {
            color: #bbb;
        }
        
        .nav-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            color: #f1f1f1;
            font-size: 30px;
            font-weight: bold;
            cursor: pointer;
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 50%;
            transition: background 0.3s ease;
            user-select: none;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        .nav-arrow:hover {
            background: rgba(0, 0, 0, 0.9);
        }
        
        .nav-arrow.prev {
            left: 20px;
        }
        
        .nav-arrow.next {
            right: 20px;
        }
        
        /* Mobile touch improvements */
        @media (max-width: 768px) {
            .nav-arrow {
                padding: 20px 25px;
                font-size: 35px;
                background: rgba(0, 0, 0, 0.8);
            }
            
            .nav-arrow.prev {
                left: 10px;
            }
            
            .nav-arrow.next {
                right: 10px;
            }
        }
        
        .model-title {
            font-size: 1.5em;
            margin-bottom: 10px;
        }
        
        .model-description {
            line-height: 1.6;
            opacity: 0.9;
        }
        
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.2em;
            opacity: 0.8;
        }
        
        .error {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #ff6b6b;
            text-align: center;
            font-size: 1.1em;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
            }
            
            .viewers-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            #viewer, #viewer2 {
                height: 300px;
            }
            
            .controls {
                gap: 10px;
            }
            
            .control-btn {
                padding: 8px 16px;
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← Back to Portfolio</a>
    
    <div class="container">
        <h1>3D Works</h1>
        <p class="subtitle">Sculptures and Digital 3D works</p>
        
        <div class="viewer-container">
            <div class="viewers-grid">
                <div class="viewer-wrapper">
                    <h3 class="viewer-title">Chapaa Model</h3>
                    <div id="viewer">
                        <div class="loading">Loading Chapaa model...</div>
                    </div>
                </div>
                
                <div class="viewer-wrapper">
                    <h3 class="viewer-title">Grape Model</h3>
                    <div id="viewer2">
                        <div class="loading">Loading grape model...</div>
                    </div>
                </div>
            </div>
            
            <div class="controls">
                <button class="control-btn active" onclick="setAutoRotate(true)">Auto Rotate Both</button>
                <button class="control-btn" onclick="setAutoRotate(false)">Manual Control</button>
                <button class="control-btn" onclick="resetCamera()">Reset Both Views</button>
            </div>
        </div>
        
        <div class="model-info">
            <h3 class="model-title">3D Model Viewer</h3>
            <p class="model-description">
                Interactive 3D model viewer with mouse controls. Click and drag to rotate, 
                scroll to zoom, and right-click to pan. Use the controls above to toggle 
                auto-rotation and other viewing options.
            </p>
        </div>
        
        <div class="gallery-section">
            <h2 class="gallery-title">Moss Bust</h2>
            <div class="series-description">
                <p>This sculpture is a piece made from chicken wire, moss, and stained glass. When approaching this project, I liked the idea of combining moss, something soft and organic, with somthing polar opposite, and that's how I decided on stained glass. The glass mosaic pieces line the cavities, with stained glass flowers and leaves growing from them, and can symbolize regrowth, and transformation. Click through the pictures to see more!</p>
            </div>
            <div class="gallery-grid">
                <div class="gallery-item">
                    <img src="images/moss1.jpg" alt="Moss 1" class="gallery-image" onclick="openModal(this)">
                </div>
                
                <div class="gallery-item">
                    <img src="images/moss2.jpg" alt="Moss 2" class="gallery-image" onclick="openModal(this)">
                </div>
                
                <div class="gallery-item">
                    <img src="images/moss3.jpg" alt="Moss 3" class="gallery-image" onclick="openModal(this)">
                </div>
                
                <div class="gallery-item">
                    <img src="images/moss4.jpg" alt="Moss 4" class="gallery-image" onclick="openModal(this)">
                </div>
                
                <div class="gallery-item">
                    <img src="images/moss5.jpg" alt="Moss 5" class="gallery-image" onclick="openModal(this)">
                </div>
                
                <div class="gallery-item">
                    <img src="images/moss6.jpg" alt="Moss 6" class="gallery-image" onclick="openModal(this)">
                </div>
            </div>
            
            <!-- Modal for enlarged images -->
            <div id="imageModal" class="modal" onclick="closeModal()">
                <span class="close" onclick="closeModal()">&times;</span>
                <span class="nav-arrow prev" onclick="event.stopPropagation(); previousImage()" ontouchstart="this.style.background='rgba(0,0,0,0.9)'" ontouchend="this.style.background='rgba(0,0,0,0.7)'">‹</span>
                <span class="nav-arrow next" onclick="event.stopPropagation(); nextImage()" ontouchstart="this.style.background='rgba(0,0,0,0.9)'" ontouchend="this.style.background='rgba(0,0,0,0.7)'">›</span>
                <img class="modal-content" id="modalImage">
                <div style="position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); color: rgba(255,255,255,0.7); font-size: 14px; text-align: center;">
                    <div>Swipe left/right or use arrows to navigate</div>
                    <div style="margin-top: 5px;">Tap outside to close</div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let scene, camera, renderer, controls, model, mixer, clock;
        let scene2, camera2, renderer2, controls2, model2, mixer2;
        let autoRotate = true;
        let wireframe = false;
        
        // Initialize the 3D scenes
        function init() {
            initScene1();
            initScene2();
            
            // Start clock for animations
            clock = new THREE.Clock();
            
            // Start render loop
            animate();
            
            // Handle window resize
            window.addEventListener('resize', onWindowResize);
        }
        
        // Initialize first scene (Chapaa)
        function initScene1() {
            const container = document.getElementById('viewer');
            
            // Create scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x2c3e50);
            
            // Create camera
            camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
            camera.position.set(0, 0, 5);
            
            // Create renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            renderer.shadowMap.enabled = false; // Disable shadows completely
            container.appendChild(renderer.domElement);
            
            // Add controls
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.autoRotate = autoRotate;
            controls.autoRotateSpeed = 2.0;
            
            // Add lighting - balanced for natural appearance
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.4);
            scene.add(ambientLight);
            
            // Hemisphere light for more natural lighting
            const hemisphereLight = new THREE.HemisphereLight(0xffffff, 0x404040, 0.3);
            scene.add(hemisphereLight);
            
            // Main directional light (moderate intensity)
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.6);
            directionalLight.position.set(10, 10, 5);
            directionalLight.castShadow = false; // Disable shadows
            scene.add(directionalLight);
            
            // Additional fill light from the opposite side
            const fillLight = new THREE.DirectionalLight(0xffffff, 0.2);
            fillLight.position.set(-10, 5, -5);
            fillLight.castShadow = false;
            scene.add(fillLight);
            
            // Placeholder will be created only if model loading fails
        }
        
        // Initialize second scene
        function initScene2() {
            const container2 = document.getElementById('viewer2');
            
            // Create scene
            scene2 = new THREE.Scene();
            scene2.background = new THREE.Color(0x2c3e50);
            
            // Create camera
            camera2 = new THREE.PerspectiveCamera(75, container2.clientWidth / container2.clientHeight, 0.1, 1000);
            camera2.position.set(0, 0, 5);
            
            // Create renderer
            renderer2 = new THREE.WebGLRenderer({ antialias: true });
            renderer2.setSize(container2.clientWidth, container2.clientHeight);
            renderer2.shadowMap.enabled = false; // Disable shadows completely
            container2.appendChild(renderer2.domElement);
            
            // Add controls
            controls2 = new THREE.OrbitControls(camera2, renderer2.domElement);
            controls2.enableDamping = true;
            controls2.dampingFactor = 0.05;
            controls2.autoRotate = autoRotate;
            controls2.autoRotateSpeed = 2.0;
            
            // Add lighting - balanced for natural appearance
            const ambientLight2 = new THREE.AmbientLight(0xffffff, 0.4);
            scene2.add(ambientLight2);
            
            // Hemisphere light for more natural lighting
            const hemisphereLight2 = new THREE.HemisphereLight(0xffffff, 0x404040, 0.3);
            scene2.add(hemisphereLight2);
            
            // Main directional light (moderate intensity)
            const directionalLight2 = new THREE.DirectionalLight(0xffffff, 0.6);
            directionalLight2.position.set(10, 10, 5);
            directionalLight2.castShadow = false; // Disable shadows
            scene2.add(directionalLight2);
            
            // Additional fill light from the opposite side
            const fillLight2 = new THREE.DirectionalLight(0xffffff, 0.2);
            fillLight2.position.set(-10, 5, -5);
            fillLight2.castShadow = false;
            scene2.add(fillLight2);
            
            // Placeholder will be created only if model loading fails
        }
        
        // Create a placeholder model for first scene
        function createPlaceholderModel() {
            const geometry = new THREE.BoxGeometry(2, 2, 2);
            const material = new THREE.MeshLambertMaterial({ 
                color: 0x4ecdc4,
                transparent: true,
                opacity: 0.8
            });
            model = new THREE.Mesh(geometry, material);
            model.castShadow = true;
            model.receiveShadow = true;
            scene.add(model);
            
            // Add some rotation animation
            model.rotation.x = 0.5;
            model.rotation.y = 0.5;
        }
        
        // Create a placeholder model for second scene
        function createPlaceholderModel2() {
            const geometry = new THREE.SphereGeometry(1.5, 32, 32);
            const material = new THREE.MeshLambertMaterial({ 
                color: 0xff6b6b,
                transparent: true,
                opacity: 0.8
            });
            model2 = new THREE.Mesh(geometry, material);
            model2.castShadow = true;
            model2.receiveShadow = true;
            scene2.add(model2);
            
            // Add some rotation animation
            model2.rotation.x = 0.3;
            model2.rotation.y = 0.3;
        }
        
        // Load a 3D model (GLTF/GLB format)
        function loadModel(modelPath) {
            const loader = new THREE.GLTFLoader();
            
            loader.load(
                modelPath,
                function(gltf) {
                    // Remove placeholder if it exists
                    if (model) {
                        scene.remove(model);
                    }
                    
                    model = gltf.scene;
                    model.scale.setScalar(2); // Adjust scale as needed
                    model.castShadow = true;
                    model.receiveShadow = true;
                    
                    // Center the model
                    const box = new THREE.Box3().setFromObject(model);
                    const center = box.getCenter(new THREE.Vector3());
                    model.position.sub(center);
                    
                    scene.add(model);
                    
                    // Set up animations if they exist
                    if (gltf.animations && gltf.animations.length > 0) {
                        mixer = new THREE.AnimationMixer(model);
                        const action = mixer.clipAction(gltf.animations[0]);
                        action.play();
                    }
                    
                    // Hide loading text
                    const loading = document.querySelector('#viewer .loading');
                    if (loading) loading.style.display = 'none';
                },
                function(progress) {
                    console.log('Loading progress:', (progress.loaded / progress.total * 100) + '%');
                },
                function(error) {
                    console.error('Error loading model:', error);
                    showError('Failed to load 3D model. Please check the file path.');
                }
            );
        }
        
        // Load an OBJ model
        function loadOBJModel(modelPath) {
            const loader = new THREE.OBJLoader();
            
            loader.load(
                modelPath,
                function(object) {
                    // Remove placeholder if it exists
                    if (model) {
                        scene.remove(model);
                    }
                    
                    model = object;
                    model.scale.setScalar(2); // Adjust scale as needed
                    
                    // Add materials and shadow properties to all meshes in the object
                    model.traverse(function(child) {
                        if (child.isMesh) {
                            child.castShadow = true;
                            child.receiveShadow = true;
                            
                            // Add a proper material if none exists or if it's too bright
                            if (!child.material || child.material.color.getHex() === 0xffffff) {
                                child.material = new THREE.MeshLambertMaterial({ 
                                    color: 0x8B4513, // Brown color for Chapaa
                                    transparent: false,
                                    opacity: 1.0
                                });
                            }
                        }
                    });
                    
                    // Center the model
                    const box = new THREE.Box3().setFromObject(model);
                    const center = box.getCenter(new THREE.Vector3());
                    model.position.sub(center);
                    
                    scene.add(model);
                    
                    // Hide loading text
                    const loading = document.querySelector('.loading');
                    if (loading) loading.style.display = 'none';
                },
                function(progress) {
                    console.log('Loading progress:', (progress.loaded / progress.total * 100) + '%');
                },
                function(error) {
                    console.error('Error loading OBJ model:', error);
                    // Create placeholder model only if loading fails
                    createPlaceholderModel();
                    const loading = document.querySelector('.loading');
                    if (loading) loading.style.display = 'none';
                    console.log('Using placeholder model for first viewer');
                }
            );
        }
        
        // Control functions
        function setAutoRotate(enabled) {
            autoRotate = enabled;
            controls.autoRotate = enabled;
            controls2.autoRotate = enabled;
            
            // Update button states
            document.querySelectorAll('.control-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }
        
        function resetCamera() {
            camera.position.set(0, 0, 5);
            camera2.position.set(0, 0, 5);
            controls.reset();
            controls2.reset();
        }
        
        function toggleWireframe() {
            wireframe = !wireframe;
            if (model) {
                model.traverse((child) => {
                    if (child.isMesh) {
                        child.material.wireframe = wireframe;
                    }
                });
            }
            
            // Update button state
            event.target.classList.toggle('active');
        }
        
        function showError(message) {
            const container = document.getElementById('viewer');
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error';
            errorDiv.textContent = message;
            container.appendChild(errorDiv);
        }
        
        // Animation loop
        function animate() {
            requestAnimationFrame(animate);
            
            if (mixer) {
                mixer.update(clock.getDelta());
            }
            if (mixer2) {
                mixer2.update(clock.getDelta());
            }
            
            controls.update();
            controls2.update();
            renderer.render(scene, camera);
            renderer2.render(scene2, camera2);
        }
        
        // Handle window resize
        function onWindowResize() {
            const container = document.getElementById('viewer');
            const container2 = document.getElementById('viewer2');
            
            // Update first viewer
            camera.aspect = container.clientWidth / container.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.clientWidth, container.clientHeight);
            
            // Update second viewer
            camera2.aspect = container2.clientWidth / container2.clientHeight;
            camera2.updateProjectionMatrix();
            renderer2.setSize(container2.clientWidth, container2.clientHeight);
        }
        
        // Initialize when page loads
        window.addEventListener('load', init);
        
        // Load the Chapaa OBJ model in the first viewer
        loadOBJModel('models/Chapaa.obj');
        
        // Load grape.obj in the second viewer (with fallback to placeholder)
        loadOBJModel2('models/grape.obj');
        
        // Load an OBJ model in the second viewer
        function loadOBJModel2(modelPath) {
            const loader = new THREE.OBJLoader();
            
            loader.load(
                modelPath,
                function(object) {
                    // Remove placeholder if it exists
                    if (model2) {
                        scene2.remove(model2);
                    }
                    
                    model2 = object;
                    model2.scale.setScalar(2); // Adjust scale as needed
                    
                    // Add materials and shadow properties to all meshes in the object
                    model2.traverse(function(child) {
                        if (child.isMesh) {
                            child.castShadow = true;
                            child.receiveShadow = true;
                            
                            // Add a proper material if none exists or if it's too bright
                            if (!child.material || child.material.color.getHex() === 0xffffff) {
                                child.material = new THREE.MeshLambertMaterial({ 
                                    color: 0x228B22, // Green color for grape
                                    transparent: false,
                                    opacity: 1.0
                                });
                            }
                        }
                    });
                    
                    // Center the model
                    const box = new THREE.Box3().setFromObject(model2);
                    const center = box.getCenter(new THREE.Vector3());
                    model2.position.sub(center);
                    
                    scene2.add(model2);
                    
                    // Hide loading text
                    const loading = document.querySelector('#viewer2 .loading');
                    if (loading) loading.style.display = 'none';
                },
                function(progress) {
                    console.log('Loading progress for model 2:', (progress.loaded / progress.total * 100) + '%');
                },
                function(error) {
                    console.error('Error loading OBJ model 2:', error);
                    // Keep the placeholder model instead of showing error
                    const loading = document.querySelector('#viewer2 .loading');
                    if (loading) loading.style.display = 'none';
                    console.log('Using placeholder model for second viewer');
                }
            );
        }
        
        // Modal functions for image enlargement
        let currentImageIndex = 0;
        let galleryImages = [];
        let startX = 0;
        let startY = 0;
        let endX = 0;
        let endY = 0;
        
        function openModal(img) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            
            // Get all gallery images
            galleryImages = Array.from(document.querySelectorAll('.gallery-image'));
            currentImageIndex = galleryImages.indexOf(img);
            
            modal.style.display = 'block';
            modalImg.src = img.src;
            
            // Add touch event listeners for swipe
            modal.addEventListener('touchstart', handleTouchStart, false);
            modal.addEventListener('touchend', handleTouchEnd, false);
        }
        
        function closeModal() {
            const modal = document.getElementById('imageModal');
            modal.style.display = 'none';
            
            // Remove touch event listeners
            modal.removeEventListener('touchstart', handleTouchStart, false);
            modal.removeEventListener('touchend', handleTouchEnd, false);
        }
        
        // Touch handling for swipe gestures
        function handleTouchStart(e) {
            startX = e.touches[0].clientX;
            startY = e.touches[0].clientY;
        }
        
        function handleTouchEnd(e) {
            endX = e.changedTouches[0].clientX;
            endY = e.changedTouches[0].clientY;
            handleSwipe();
        }
        
        function handleSwipe() {
            const deltaX = endX - startX;
            const deltaY = endY - startY;
            const minSwipeDistance = 50;
            
            // Check if it's a horizontal swipe (not vertical)
            if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > minSwipeDistance) {
                if (deltaX > 0) {
                    // Swipe right - previous image
                    previousImage();
                } else {
                    // Swipe left - next image
                    nextImage();
                }
            }
        }
        
        function nextImage() {
            if (galleryImages.length === 0) return;
            currentImageIndex = (currentImageIndex + 1) % galleryImages.length;
            const modalImg = document.getElementById('modalImage');
            modalImg.src = galleryImages[currentImageIndex].src;
        }
        
        function previousImage() {
            if (galleryImages.length === 0) return;
            currentImageIndex = (currentImageIndex - 1 + galleryImages.length) % galleryImages.length;
            const modalImg = document.getElementById('modalImage');
            modalImg.src = galleryImages[currentImageIndex].src;
        }
        
        // Close modal when clicking outside the image
        document.getElementById('imageModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
        
        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            const modal = document.getElementById('imageModal');
            if (modal.style.display === 'block') {
                if (e.key === 'Escape') {
                    closeModal();
                } else if (e.key === 'ArrowLeft') {
                    previousImage();
                } else if (e.key === 'ArrowRight') {
                    nextImage();
                }
            }
        });
    </script>
</body>
</html>